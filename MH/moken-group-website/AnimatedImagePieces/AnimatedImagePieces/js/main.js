{const t=navigator.userAgent.indexOf("Firefox")>0;function debounce(t,i,e){var s;return function(){var o=this,n=arguments,a=e&&!s;clearTimeout(s),s=setTimeout(function(){s=null,e||t.apply(o,n)},i),a&&t.apply(o,n)}}const i=t=>{let i=0,e=0;if(!t){window.event}return t.pageX||t.pageY?(i=t.pageX,e=t.pageY):(t.clientX||t.clientY)&&(i=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:i,y:e}};class e{constructor(t,i){this.DOM={},this.DOM.el=t,this.options={pieces:{rows:12,columns:10},hasTilt:!1,tilt:{maxRotationX:-2,maxRotationY:2,maxTranslationX:4,maxTranslationY:-2},delay:0,bgimage:"none",animationDefaults:{duration:600,easing:[.2,1,.3,1],delay:(t,i)=>i*parseInt(t.dataset.delay),translateX:(t,i)=>t.dataset.column<this.getTotalColumns()/2?anime.random(50,100)+"px":anime.random(-100,-50)+"px",translateY:(t,i)=>anime.random(-1e3,-800)+"px",opacity:{value:0,duration:600,easing:"linear"}}},Object.assign(this.options,i),this.init()}init(){this.win={width:window.innerWidth,height:window.innerHeight},this.dimensions={width:this.DOM.el.offsetWidth,height:this.DOM.el.offsetHeight},this.layout(),this.options.hasTilt&&this.initTilt(),this.initEvents()}layout(){this.imgsrc=this.DOM.el.style.backgroundImage.replace("url(","").replace(")","").replace(/\"/gi,""),this.DOM.el.style.backgroundImage="none"!==this.options.bgimage?`url(${this.options.bgimage})`:"none",this.pieces=[];for(let t=0;t<this.options.pieces.rows;t++)for(let i=0;i<this.options.pieces.columns;i++){const e=this.createPiece(t,i);e.style.backgroundPosition=`${-1*i*100}% ${-100*t}%`,this.pieces.push(e)}}createPiece(t,i){const e=Math.round(this.dimensions.width/this.options.pieces.columns),s=Math.round(this.dimensions.height/this.options.pieces.rows),o=document.createElement("div");return o.style.backgroundImage=`url(${this.imgsrc})`,o.className="piece",o.style.width=`${e}px`,o.style.height=`${s}px`,o.style.backgroundSize=`${e*this.options.pieces.columns+4}px auto`,o.dataset.row=t,o.dataset.column=i,o.dataset.delay=this.options.delay instanceof Array?anime.random(this.options.delay[0],this.options.delay[1]):this.options.delay,this.DOM.el.appendChild(o),this.DOM.el.style.width=`${e*this.options.pieces.columns}px`,this.DOM.el.style.height=`${s*this.options.pieces.rows}px`,o}setImage(t){this.imgsrc=t;for(const t of this.pieces)t.style.backgroundImage=`url(${this.imgsrc})`}initTilt(){t||(this.DOM.el.style.transition="transform 0.2s ease-out",this.tilt=!0)}removeTilt(){t||(this.tilt=!1)}initEvents(){const e=debounce(()=>{this.win={width:window.innerWidth,height:window.innerHeight},this.DOM.el.style.width=this.DOM.el.style.height="";const t=this.DOM.el.getBoundingClientRect();this.dimensions={width:t.width,height:t.height};for(let t=0,i=this.pieces.length;t<i;t++){const i=Math.round(this.dimensions.width/this.options.pieces.columns),e=Math.round(this.dimensions.height/this.options.pieces.rows),s=this.pieces[t];s.style.width=`${i}px`,s.style.height=`${e}px`,s.style.backgroundSize=`${i*this.options.pieces.columns+4}px auto`,this.DOM.el.style.width=`${i*this.options.pieces.columns}px`,this.DOM.el.style.height=`${e*this.options.pieces.rows}px`}},20);document.addEventListener("mousemove",e=>{requestAnimationFrame(()=>{if(!this.tilt)return t&&(this.DOM.el.style.transform="none"),!1;const s=i(e),o=document.body.scrollLeft+document.documentElement.scrollLeft,n=document.body.scrollTop+document.documentElement.scrollTop,a=s.x-o,h=s.y-n,l=2*this.options.tilt.maxRotationX/this.win.height*h-this.options.tilt.maxRotationX,r=2*this.options.tilt.maxRotationY/this.win.width*a-this.options.tilt.maxRotationY,c=2*this.options.tilt.maxTranslationX/this.win.width*a-this.options.tilt.maxTranslationX,d=2*this.options.tilt.maxTranslationY/this.win.height*h-this.options.tilt.maxTranslationY;this.DOM.el.style.transform=`perspective(1000px) translate3d(${c}px, ${d}px,0) rotate3d(1,0,0,${l}deg) rotate3d(0,1,0,${r}deg)`})}),window.addEventListener("resize",t=>e())}getTotalRows(){return this.options.pieces.rows}getTotalColumns(){return this.options.pieces.columns}animate(t){t=t||this.options.animationDefaults;let i={targets:this.pieces};Object.assign(i,t),anime.remove(this.pieces),anime(i)}}window.Pieces=e}